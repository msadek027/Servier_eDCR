
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script src="~/AdminLTE/plugins/jQuery/jquery-2.2.3.min.js"></script>
<link href="~/Content/CustomCSS/InputText.css" rel="stylesheet" />
<link href="~/Content/CustomCSS/exportPDF.css" rel="stylesheet" />
<script src="~/Scripts/CustomJS/DefaultValue.js"></script>


<div class="box-header with-border">
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

            <form class="form" action="/ReportExpenseBillMpoTmRsmDepot/Export" id="R1Form" method="post" name="H1Form" target="_blank">
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-md-2 col-lg-2"><div id="MessageText"></div></div>
                    <div class="col-xs-0 col-sm-0 col-md-10 col-lg-10">
                        <div style="text-align:right;">
                            <button id="btnExcel" class="btn btn-primary btn-sm" name="ExportType" value="Excel" type="submit"><i class="glyphicon glyphicon-envelope"></i> Excel </button>
                            <button id="btnPDF" class="btn btn-primary btn-sm" name="ExportType" value="PDF" type="submit"><i class="glyphicon glyphicon-book"></i> PDF </button>
                            <button id="btnView" class="btn btn-primary btn-sm" type="button"><i class="glyphicon glyphicon-file"></i> View</button>
                            <button id="btnSave" class="btn btn-primary btn-sm" type="button"><i class="glyphicon glyphicon-ok"></i> All Save</button>
                        </div>

                    </div>
                </div>
                <div class="box-body">

                    <div class="row" id="divValueParameter">
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3"> Month - Year :</div>
                            <div class="col-xs-0 col-sm-0 col-md-6 col-lg-6">
                                <div class="input-group">
                                    <select id="MonthNumber" name="MonthNumber" class=" RequiredField form-control" readonly></select>
                                    <span class="input-group-btn" style="width:0px;"></span>
                                    <input type="text" id="Year" name="Year" class="RequiredField form-control" readonly />
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3">Depot Name :</div>
                            <div class="col-xs-0 col-sm-0 col-md-6 col-lg-6">
                                <select id="DepotCode" name="DepotCode" class="RequiredField form-control"></select>
                                <input type="hidden" id="DepotName" name="DepotName" class="RequiredField form-control">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3">Designation - SBU :</div>
                            <div class="col-xs-0 col-sm-0 col-md-6 col-lg-6">
                                <div class="input-group">
                                    <select id="Designation" name="Designation" class="RequiredField form-control">
                                        <option value=""></option>
                                        <option value="DSM">DSM</option>
                                        <option value="RSM">RSM</option>
                                        <option value="TM">TM</option>
                                        <option value="MPO">MPO</option>
                                    </select>
                                    <span class="input-group-btn" style="width:0px;"></span>
                                    <select id="SBU" name="SBU" class="RequiredField form-control">
                                        <option value=""></option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="C">C</option>
                                        <option value="D">D</option>
                                        <option value="E">E</option>
                                        <option value="N">N</option>
                                        <option value="HB">HB</option>
                                        <option value="HB1">HB1</option>
                                        <option value="HB2">HB2</option>
                                        <option value="HB3">HB3</option>
                                    </select>
                                </div>



                            </div>
                        </div>






                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3"><input type="checkbox" id="ChkEmployeeCode" name="ChkEmployeeCode" class="checkbox-primary" value="True"> Left Employee:</div>
                            <div class="col-xs-0 col-sm-0 col-md-6 col-lg-6">
                                <select id="EmployeeCode" name="EmployeeCode" class="EmployeeCode RequiredField form-control" multiple="multiple"></select>
                                <input type="hidden" id="EmployeeCode2" name="EmployeeCode2" class="RequiredField form-control">

                            </div>
                            <div class="col-xs-0 col-sm-0 col-md-3 col-lg-3"></div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3"><input type="checkbox" id="ChkSpecificEmployeeCode" name="ChkSpecificEmployeeCode" class="checkbox-primary" value="True"> Specific Employee:</div>
                            <div class="col-xs-0 col-sm-0 col-md-6 col-lg-6">
                                <select id="SpecificEmployeeCode" name="SpecificEmployeeCode" class="RequiredField form-control"></select>

                            </div>
                            <div class="col-xs-0 col-sm-0 col-md-3 col-lg-3"></div>
                        </div>
                        <br />
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3"></div>
                            <div class="col-xs-0 col-sm-0 col-md-6 col-lg-6">
                                <button id="btnExcel" class="btn btn-primary btn-sm" name="ExportType" value="AllDepotDataToExcelExport" formaction="/ReportExpenseBillMpoTmRsmDepot/AllDepotDataToExcelExport" type="submit"><i class="glyphicon glyphicon-envelope"></i>All Depot Data to Excel </button>

                            </div>
                            <div class="col-xs-0 col-sm-0 col-md-3 col-lg-3"></div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<div class="row">
    <div id="MainGrid" class="MainGrid"></div>
</div>



<div class="row">
    <div id="TerritoryPopupWindow" class="PopupWindowLayout" style="display: none;">
        <div id="TerritoryPopupWindowGrid" class="PopUpGrid"></div>
    </div>
</div>

<div class="row">
    <div id="PopupWindow" class="PopupWindowLayout" style="display: none;">
        <div id="PopupWindowGrid" class="PopUpGrid"></div>
    </div>
</div>



<div id="divLoading" style="margin: 0px; padding: 0px; position: fixed; right: 0px;
    top: 0px; width: 100%; height: 100%; background-color: #666666; z-index: 30001;
    opacity: .8; filter: alpha(opacity=70);display:none">
    <p style="position: absolute; top: 50%; left: 50%; color: White;">
        <img src="~/Content/Images/loading.gif" />
    </p>
</div>






<script>

    $(document).ready(function () {
        $.ajaxSetup({
            beforeSend: function () {
                $("#divLoading").show();
            },
            complete: function () {
                $("#divLoading").hide();
            }
        });


       // EventPermission();
        LoadMonth();

        var now = new Date();
        var prevMonthLastDate = new Date(now.getFullYear(), now.getMonth(), 0);
        var PreviousYear = prevMonthLastDate.getFullYear();

        $(".datepicker").datepicker({
            format: " yyyy",
            viewMode: "years",
            minViewMode: "years",
            autoclose: true
        });

        // $("#Year").val(yyyy);
        $("#Year").val(PreviousYear);



        //$('#Year').attr('disabled', true);
        //$('#MonthNumber').attr('disabled', true);

        function LoadMonth() {
            $.ajax({
                url: '/Default/GetGenPreviousMonth',
                type: 'GET',
                dataType: 'JSON',
                data: "{}",
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    $.each(data, function (i, item) {
                        $('#MonthNumber').append($('<option>', { value: item.MonthNumber, html: item.MonthName }, '<option/>'));
                    });
                },
                error: function () {
                    alert("Failed to load !!");
                }
            });
        }


        LoadDepot();
        function LoadDepot() {
            $.ajax({
                url: '/Default/GetDepot',
                type: 'get',
                dataType: 'json',
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    $.each(data, function (i, item) {

                        if (i == 0) {
                            if (data.length > 1) {
                                GetLeftEmpForSup($('#DepotCode').val());

                                //$('#DepotCode').append('<option value="" selected="selected"></option>');
                            }

                            $('#DepotName').val(item.DepotName);
                        }
                        $('#DepotCode').append($('<option>', { value: item.DepotCode, html: item.DepotName }, '<option/>'));

                    });
                },
                error: function () {
                    alert("Failed to load...");
                }
            });
        }
        $('#DepotCode').on('change', function () {
            $('#DepotName').val($("#DepotCode option:selected").text());
            $('#Designation').val('');
            $('#SBU').val('');        
            $('#EmployeeCode').empty();
            GetLeftEmpForSup($('#DepotCode').val());

        }).trigger('change');

        GetSpecificEmpForSup($('#DepotCode').val());

        var ChkEmployeeCodeValue = false;
        $("#EmployeeCode").multiselect({
            enableFiltering: false, allSelectedText: 'All', includeSelectAllOption: true, maxHeight: 200, maxWidth: 200,
            onChange: function (option, checked, select) {
                //alert("onchange"); // Works but not for 'All Selected'
            },
            onSelectAll: function () {
                // console.log("call when select all");
                $('#ChkEmployeeCode').prop('checked', true);
                ChkEmployeeCodeValue = true;
            },
            onDeselectAll: function () {
                $('#ChkEmployeeCode').prop('checked', false);
                ChkEmployeeCodeValue = false;
            }
        }).multiselect('selectAll', false).multiselect('updateButtonText').trigger('reset');

       
       
        $('#EmployeeCode').on('change', function () {       
            $('#EmployeeCode2').val($("#EmployeeCode").val());
        }).trigger('change');;
        function GetLeftEmpForSup(DepotCode) {
            $('#ChkEmployeeCode').prop('checked', false);
            var MonthYear = $('#MonthNumber').val() + "-" + $('#Year').val();
            if (DepotCode != "") {
                $.ajax({
                    type: "POST",
                    url: '/Default/GetLeftEmpForDepotDesignation',
                    data: JSON.stringify({ DepotCode: DepotCode, MonthYear: MonthYear }),
                    dataType: 'json',
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {
                        debugger;
                        console.log("len:"+data);
                        $('#EmployeeCode').empty();
                        if (data.length > 0) {
                            $.each(data, function (i, item) {                                
                                    if (i == 0) {
                                        if (data.length > 1) {
                                            $('#EmployeeCode option').prop('selected', true);
                                            $('#EmployeeCode').append('<option value="" selected="selected"></option>');
                                        }
                                    }
                                    $('#EmployeeCode').append($('<option>', { value: item.LocCode, html: item.EmployeeName }, '<option/>')).multiselect('rebuild');
                               
                            });
                        }
                        else {

                            $('#EmployeeCode').append($('<option>', { value: "", html: "" }, '<option/>')).multiselect('rebuild');
                        }
                    },
                    error: function () {
                        alert("Failed to load... !!");
                    }
                });
            }
            else {

                $('#ChkEmployeeCode').prop('checked', false);
                ChkEmployeeCodeValue = false;
                $('#EmployeeCode').append('<option value="" selected="selected"></option>').multiselect('rebuild');
            }
        }


        $('#SpecificEmployeeCode').select2();
        function GetSpecificEmpForSup(DepotCode) {
            if (DepotCode != "" || DepotCode == "") {
                $.ajax({
                    type: "POST",
                    url: '/Default/GetSpecificEmpForDepotDesignation',
                    data: JSON.stringify({ DepotCode: DepotCode, Year: $('#Year').val(), MonthNumber: $('#MonthNumber').val() }),
                    dataType: 'json',
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {
                        $('#SpecificEmployeeCode').empty();
                        $.each(data, function (i, item) {
                            if (i == 0) {
                                if (data.length > 1) {
                                    $('#SpecificEmployeeCode').append('<option value="" selected="selected"></option>');
                                }
                            }

                            $('#SpecificEmployeeCode').append($('<option>', { value: item.LocCode, html: item.EmployeeName }, '<option/>'));


                        });

                    },
                    error: function () {
                        alert("Failed to load... !!");
                    }
                });
            }
            else {
                $('#SpecificEmployeeCode').append('<option value="" selected="selected"></option>');
            }
        }



        $('#IsActive').click(function () {
            if ($(this).is(':checked')) {
                $(this).siblings('label').html('Unhide');
                $('#divValueParameter').hide();
            }
            else {
                $(this).siblings('label').html('Hide');
                $('#divValueParameter').show();
            }
        });

          

        $('#ChkEmployeeCode').click(function () {        
            if ($(this).is(':checked')) {
                ChkEmployeeCodeValue = $('#ChkEmployeeCode').prop('checked');
                ChkSpecificEmployeeCodeValue = false;
                $("#ChkSpecificEmployeeCode").prop('checked', false);              
            }
            else { ChkEmployeeCodeValue = $('#ChkEmployeeCode').prop('checked'); }
        });
        var ChkSpecificEmployeeCodeValue = false;
        $('#ChkSpecificEmployeeCode').click(function () {

            if ($(this).is(':checked')) {
                ChkSpecificEmployeeCodeValue = $('#ChkSpecificEmployeeCode').prop('checked');
                ChkEmployeeCodeValue = false;
                $("#ChkEmployeeCode").prop('checked', false);

            }
            else { ChkSpecificEmployeeCodeValue = $('#ChkSpecificEmployeeCode').prop('checked'); }
        });

        $('#btnView').click(function () {
            $("body").addClass('sidebar-collapse').trigger('collapsed.pushMenu');
            $('#MainGrid').data('kendoGrid').dataSource.filter([]);
            $('#MainGrid').data('kendoGrid').dataSource.data([]);

            var model = {};
            debugger;

            model.Year = $("#Year").val();
            model.MonthNumber = $("#MonthNumber").val();
            model.Designation = $("#Designation").val();

            const selected = document.querySelectorAll('#EmployeeCode option:checked');
            const values = Array.from(selected).map(el => el.value).length;
            if ($('#EmployeeCode option').length == values && $('#EmployeeCode option').size() == values) {
                model.EmployeeCode = JSON.stringify($("#EmployeeCode").val());
            }
            else {
                model.EmployeeCode = JSON.stringify($("#EmployeeCode").val());
            }


    
            model.SpecificEmployeeCode = $("#SpecificEmployeeCode").val();

            model.DepotCode = $("#DepotCode").val();
            model.SBU = $("#SBU").val();
            model.BillStatus = $("#BillStatus").val();

            model.ChkEmployeeCode = ChkEmployeeCodeValue;
            model.ChkSpecificEmployeeCode = ChkSpecificEmployeeCodeValue;

            var Input = InputValidation('MonthNumber') + InputValidation('Year') + InputValidation('DepotCode');
            if (Input == 0) {
                $("#divLoading").show();
                $.ajax({
                    type: "POST",
                    url: "/ReportExpenseBillMpoTmRsmDepot/GetSummaryData",
                    data: JSON.stringify({ model: model }),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (data) {
                        if (data.length > 0) {

                            $("#MainGrid").data("kendoGrid").dataSource.data(data);
                        }
                        $("#divLoading").hide();
                    },

                });
            }
            else {
                ValidationMsg();
                toastr.warning($("#MessageText").html());
            }
            $("#Year").val(model.Year);
        });



        var MainGrid = $('#MainGrid').kendoGrid({
            dataSource: new kendo.data.DataSource({
                batch: false,
                schema: {
                    model: {
                        id: "EmployeeCode",
                        fields: {
                            SL: { type: "string" },
                            EmployeeCode: { type: "string" },
                            EmployeeName: { type: "string" },
                            Designation: { type: "string" },

                            MarketName: { type: "string" },
                            TerritoryName: { type: "string" },
                            RegionName: { type: "string" },
                            DepotName: { type: "string" },
                            DA: { type: "string" },
                            TA: { type: "string" },
                            WaitingTotal: { type: "string" },
                            ApproveTotal: { type: "string" },
                            MiscManualTADABill: { type: "Number" },
                            GrandTotal: { type: "string" },
                        }
                    }
                },
                pageSize: 100,
            }),
            pageable: {
                pageSizes: true, buttonCount: 10
            },

            dataBound: function (e) {
                AutoFitColumn(this.element[0].id);
            },

            edit: function (e) {
                $('input[name = "EmployeeCode"]').attr("readonly", true);
                $('input[name = "Designation"]').attr("readonly", true);
                $('input[name = "EmployeeName"]').attr("readonly", true);

                $('input[name = "MarketName"]').attr("readonly", true);
                $('input[name = "TerritoryName"]').attr("readonly", true);
                $('input[name = "RegionName"]').attr("readonly", true);
                $('input[name = "DepotName"]').attr("readonly", true);
                $('input[name = "SL"]').attr("readonly", true);

                $('input[name = "DA"]').attr("readonly", true);
                $('input[name = "TA"]').attr("readonly", true);
                $('input[name = "WaitingTotal"]').attr("readonly", true);
                $('input[name = "ApproveTotal"]').attr("readonly", true);
                $('input[name = "GrandTotal"]').attr("readonly", true);
            },
           
            selectable: "row",
            //selectable: "multiple",
            toolbar: [{ template: "<input type='text' id='txtMarketInput'  style='float:right' placeholder='Market Name' class='k-textbox'>" }, { template: "<input type='text' id='txtDesignationInput'  style='float:right' placeholder='Designation' class='k-textbox'>" }, { template: "<input type='text' id='txtEmployeeInput'  style='float:right' placeholder='Emp ID Or Name' class='k-textbox'>" },],
            height: 450,
            scrollable: true,
            sortable: true,
            filterable: false,
            editable: true,
            navigatable: false,
            columnMenu: false,
            reorderable: false,
            //resizable: true,
            //resize: function (e) {
            //    this.table.height(this.element.height() + this.table.height() - 1);
            //},
            columns: [
                { field: "SL", title: "SL", width: 15, locked: true },
                { field: "EmployeeCode", title: "Employee<br/> Code", width: 30, locked: true },
                { field: "EmployeeName", title: "Employee Name", width: 30, locked: true },
                { field: "Designation", title: "Designation", width: 30, locked: true },
                { field: "MarketName", title: "Market Name", locked: true },
                { field: "TerritoryName", title: "Territory Name", width: 30 },
                { field: "RegionName", title: "Region Name", },
                { field: "DepotName", title: "Depot<br/>Name", },
                { field: "DA", title: "Daily<br/>Allowance", width: 40 },
                { field: "TA", title: "Travel<br/>Allowance", width: 40 },
                { field: "WaitingTotal", title: "Waiting<br/>Total", width: 40 },
                { field: "ApproveTotal", title: "Approve<br/>Total", width: 40 },
                { field: "MiscManualTADABill", title: "Misc/<br/>Manual<br/>TA DA<br/>Bill", width: 40 },
                { field: "GrandTotal", title: "Grand<br/>Total", width: 40 },


                { command: [{ name: "PreviewRow", text: "Preview", imageClass: "k-icon k-i-close", click: handlePreview }], title: "Link", headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;text-align: center;" } },
                { command: [{ name: "ApprovedRow", text: "Save", imageClass: "k-icon k-i-close", click: handleApproved }], title: "Save", headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;text-align: center;" } }
            ],
        }).data('kendoGrid');


        $("#txtEmployeeInput").keyup(function () {

            var val = $(this).val();
            $("#txtDesignationInput").val('');
            $("#txtMarketInput").val('');
            $("#MainGrid").data("kendoGrid").dataSource.filter({
                logic: "or",
                filters: [
                    { field: "EmployeeCode", operator: "contains", value: val },
                    { field: "EmployeeCode", operator: "contains", value: val },

                ]
            });
        });

        $("#txtDesignationInput").keyup(function () {
            var val = $(this).val();
            $("#txtEmployeeInput").val('');
            $("#txtMarketInput").val('');
            $("#MainGrid").data("kendoGrid").dataSource.filter({
                logic: "or",
                filters: [
                    { field: "Designation", operator: "contains", value: val },
                ]
            });
        });

        $("#txtMarketInput").keyup(function () {
            var val = $(this).val();
            $("#txtEmployeeInput").val('');
            $("#txtDesignationInput").val('');
            $("#MainGrid").data("kendoGrid").dataSource.filter({
                logic: "or",
                filters: [
                    { field: "MarketName", operator: "contains", value: val },
                ]
            });
        });

        function handlePreview(e) {
            e.preventDefault();
            var selectedItem = MainGrid.dataItem($(e.currentTarget).closest("tr"));

            if ($("#Year").val() != "" && $("#MonthNumber").val() != "") {
                ReportHeader = "Month: " + $("#MonthNumber option:selected").text() + " " + $("#Year").val() + ", Employee: " + selectedItem.EmployeeCode + ", " + selectedItem.EmployeeName + ", " + selectedItem.Designation + "," + selectedItem.MarketName;

            }

            sessionStorage.setItem('keyYear', $("#Year").val());
            sessionStorage.setItem('keyMonthNumber', $("#MonthNumber").val());


            sessionStorage.setItem('keyLocName', selectedItem.MarketName);
            sessionStorage.setItem('keyEmployeeCode', selectedItem.EmployeeCode);
            sessionStorage.setItem('keyEmployeeName', selectedItem.EmployeeName);
            sessionStorage.setItem('keyDesignation', selectedItem.Designation);
            sessionStorage.setItem('keyReportHeader', ReportHeader);

            var Year = $("#Year").val();
            var MonthNumber = $("#MonthNumber").val();

            var Input = InputValidation('MonthNumber') + InputValidation('Year');
            if (Input == 0) {
                window.open("/DCR/ReportExpenseBillMpoTmRsmDepot/frmReportExpenseBillMpoTmRsmDepotDetail");
            }
        };


        function handleApproved(e) {

            e.preventDefault();
            var selectedItem = MainGrid.dataItem($(e.currentTarget).closest("tr"));
            var model = {};
            model.Year = $("#Year").val();
            model.MonthNumber = $("#MonthNumber").val();
            model.TerritoryManagerID = $("#TerritoryManagerID").val();
            model.ItemList = [];

            var detail = {};

            detail.EmployeeCode = selectedItem.EmployeeCode;
            detail.Designation = selectedItem.Designation;

            detail.MiscManualTADABill = selectedItem.MiscManualTADABill;



            detail.MonthNumber = $('#MonthNumber').val();
            detail.Year = $('#Year').val();
            model.ItemList.push(detail);

            $.ajax({
                url: '/ReportExpenseBillMpoTmRsmDepot/OperationsModeSummary',
                data: JSON.stringify(model),
                type: 'POST',
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data) {
                    if (data.Status == "Yes") {
                        OperationMsg(data.Mode);
                        toastr.success($("#MessageText").html());
                    }
                    else {
                        ErrorFrmServerMsg(data.Status);
                        toastr.warning($("#MessageText").html());
                    }

                },
                error: function () {
                    ErrorFrmClientMsg();
                    toastr.warning($("#MessageText").html());
                },
                // complete: function () { CompletedMsg(); },
            }); //End of ajax call

        };

        var gridInput = 0;
        function GridValidation() {
            gridInput = 0;
            var dataSource = $("#MainGrid").data("kendoGrid").dataSource;
            data = dataSource.data(); // Get Detail Grid Data
            if (dataSource.view().length > 0) {
                for (var i = data.length - 1; i >= 0; i--) {
                    if (data[i].EmployeeCode == "" || data[i].EmployeeCode == null) {
                        gridInput = 1;
                    }
                }
            }
            else {
                gridInput = 1;
            }
        }
        $('#btnSave').click(function () {
            GridValidation();

            var model = {};
            model.Year = $("#Year").val();
            model.MonthNumber = $("#MonthNumber").val();



            var detailDataSource = $('#MainGrid').data("kendoGrid").dataSource;
            var detailData = detailDataSource.data();
            model.ItemList = [];
            if (gridInput == 0) {

                if (detailData.length > 0) {
                    for (var i = 0; i < detailData.length; i++) {

                        var detail = {};

                        detail.EmployeeCode = detailData[i].EmployeeCode;
                        detail.Designation = detailData[i].Designation;

                        detail.MiscManualTADABill = detailData[i].MiscManualTADABill;

                        detail.MonthNumber = $('#MonthNumber').val();
                        detail.Year = $('#Year').val();

                        model.ItemList.push(detail);
                    }
                }
                $.ajax({
                    url: '/ReportExpenseBillMpoTmRsmDepot/OperationsModeSummary',
                    data: JSON.stringify(model),
                    type: 'POST',
                    contentType: 'application/json;',
                    dataType: 'json',
                    success: function (data) {
                        if (data.Status == "Yes") {
                            OperationMsg(data.Mode);
                            toastr.success($("#MessageText").html());
                        }
                        else {
                            ErrorFrmServerMsg(data.Status);
                            toastr.warning($("#MessageText").html());
                        }
                    },
                    error: function () {
                        ErrorFrmClientMsg();
                        toastr.warning($("#MessageText").html());
                    },
                    // complete: function () { CompletedMsg(); },
                }); //End of ajax call

            }
            else {
                ValidationMsg();
                toastr.warning($("#MessageText").html());
            }


        });






    });


</script>

