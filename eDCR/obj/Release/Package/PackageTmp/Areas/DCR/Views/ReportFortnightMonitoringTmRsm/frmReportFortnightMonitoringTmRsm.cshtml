@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script src="~/AdminLTE/plugins/jQuery/jquery-2.2.3.min.js"></script>
<link href="~/Content/CustomCSS/InputText.css" rel="stylesheet" />
<link href="~/Content/CustomCSS/exportPDF.css" rel="stylesheet" />
<script src="~/Scripts/CustomJS/DefaultValue.js"></script>

<script src="~/Scripts/HtmlPDF/dist/jspdf.min.js"></script>

<meta charset="UTF-8">


<style>
    /* BASICS: */
    * {
        padding: 0;
        margin: 0;
        box-sizing: border-box; /* in case block elements are used inside table cells */
    }

    html {
        font-size: 62.5%; /* standardizes older IEs */
    }

    body {
        font: normal 1.3em Verdana; /* = 13px */
        padding: 1px;
    }

    table {
        border-collapse: collapse;
        table-layout: fixed;
        width: 100%;
    }

    td {
        border: 1px solid black;
        /*padding: 4px;*/
    }
    /* SCROLL TABLE ESSENTIALS (+ SOME ADDITIONAL CSS): */
    div#scrollTableContainer {
        width: 100%;
        table-layout: fixed;
        /*margin: 5px;*/ /* just for presentation purposes */
        /*border: 1px solid black;*/
    }

    .touchScreen div#scrollTableContainer {
        width: 100%; /* touch devices do not form scrollbars (= 17 px wide) */
    }

    #tHeadContainer {
        background: #666633;
        color: white;
        font-size: small;
        text-align: center;
        width: 99%;
        /*table-layout: fixed;*/
    }


    #tBodyContainer {
        min-height: 100px;
        max-height: 250px;
        width: 100%;
        overflow-y: scroll;
        font-size: small;
        text-align: center;
        overflow-x: hidden;
        table-layout: fixed;
    }


    .touchScreen #tBodyContainer {
        -webkit-overflow-scrolling: touch; /* smooths scrolling on touch screens */
    }
    /* FINER LAYOUT MATTERS: */
    tr:first-child td {
        border-top: 0;
    }



    #tBody tr.lastRow td {
        border-bottom: 0;
    }


    /* AND SOME CSS TO INFORM TOUCH SCREEN USERS: */
    p#touchDeviceText {
        display: none;
    }

    .touchScreen p#touchDeviceText {
        display: block;
    }

    .Code {
        width: 0%;
        display: none;
    }
















    #tHeadContainer2 {
        background: #666633;
        color: white;
        font-size: small;
        text-align: center;
        width: 99%;
        /*table-layout: fixed;*/
    }


    #tBodyContainer2 {
        min-height: 80px;
        max-height: 120px;
        width: 100%;
        overflow-y: scroll;
        font-size: small;
        text-align: center;
        overflow-x: hidden;
        table-layout: fixed;
    }


    .touchScreen #tBodyContainer2 {
        -webkit-overflow-scrolling: touch; /* smooths scrolling on touch screens */
    }

    #tBody2 tr.lastRow td {
        border-bottom: 0;
    }





    #tHeadContainer3 {
        background: #666633;
        color: white;
        font-size: small;
        text-align: center;
        width: 99%;
        /*table-layout: fixed;*/
    }


    #tBodyContainer3 {
        min-height: 80px;
        max-height: 120px;
        width: 100%;
        overflow-y: scroll;
        font-size: small;
        text-align: center;
        overflow-x: hidden;
        table-layout: fixed;
    }


    .touchScreen #tBodyContainer3 {
        -webkit-overflow-scrolling: touch; /* smooths scrolling on touch screens */
    }

    #tBody3 tr.lastRow td {
        border-bottom: 0;
    }




    #tHeadContainer4 {
        background: #666633;
        color: white;
        font-size: small;
        text-align: center;
        width: 99%;
        /*table-layout: fixed;*/
    }


    #tBodyContainer4 {
        min-height: 100px;
        max-height: 150px;
        width: 100%;
        overflow-y: scroll;
        font-size: small;
        text-align: center;
        overflow-x: hidden;
        table-layout: fixed;
    }

    
    #tHeadContainer5 {
        background: #666633;
        color: white;
        font-size: small;
        text-align: center;
        width: 99%;
        /*table-layout: fixed;*/
    }


    #tBodyContainer5 {
        min-height: 100px;
        max-height: 150px;
        width: 100%;
        overflow-y: scroll;
        font-size: small;
        text-align: center;
        overflow-x: hidden;
        table-layout: fixed;
    }

    .touchScreen #tBodyContainer4 {
        -webkit-overflow-scrolling: touch; /* smooths scrolling on touch screens */
    }

    #tBody4 tr.lastRow td {
        border-bottom: 0;
    }
</style>


<script>
    if ('ontouchstart' in window || (window.DocumentTouch && document instanceof DocumentTouch)) {
        document.documentElement.className += ' touchScreen ';
    }
</script>


<script>
    $(document).ready(function () {

        $.ajaxSetup({
            beforeSend: function () {
                $("#divLoading").show();
            },
            complete: function () {
                $("#divLoading").hide();
            }
        });

        EventPermission();
        $("#btnExcel").attr("disabled", true);
        $("#btnPDF").attr("disabled", true);

        $(".datepicker").datepicker({
            format: " yyyy",
            viewMode: "years",
            minViewMode: "years",
            autoclose: true
        });
        $("#Year").val(yyyy);
        LoadMonth();


        function LoadMonth() {
            $.ajax({
                url: '/Default/GetGenMonth',
                type: 'GET',
                dataType: 'JSON',
                data: "{}",
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    $.each(data, function (i, item) {
                        $('#MonthNumber').append($('<option>', { value: item.MonthNumber, html: item.MonthName }, '<option/>'));
                    });
                },
                error: function () {
                    alert("Failed to load ... !!");
                }
            });
        }

        LoadRegion();

        function LoadRegion() {
            $.ajax({
                url: '/Default/GetRegion',
                type: 'get',
                dataType: 'json',
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    $('#RegionCode').empty();
                    $('#LocCode').empty();
                    // $('#Designation').empty();
                    $.each(data, function (i, item) {
                        if (i === 0) {
                            if (data.length > 1) {
                                $('#RegionCode').append('<option value="" selected="selected"></option>');
                            }
                            $('#RegionName').val(item.RegionName);
                        }
                        $('#RegionCode').append($('<option>', { value: item.RegionCode, html: item.RegionName }, '<option/>'));
                    });
                },
                error: function () {
                    alert("Failed to load...");
                }
            });
        }
        $('#RegionCode').on('change', function () {         
            $('#RegionName').val($("#RegionCode option:selected").text());
            $('#Designation').val('');
            $('#LocCode').empty();

        }).trigger('change');;

        $('#Designation').on('change', function () {

            GetEmpForSup($("#RegionCode").val(), $(this).val());
            
                if ($(this).val() == "RSM" || $(this).val() == "DSM") {
                $('#FortNightType').val('Full');
                $('#scrollTableContainer2').hide();
                $('#scrollTableContainer3').hide();
            }
            if ($(this).val() == "TM") {
                $('#FortNightType').val('First');
                $('#scrollTableContainer2').show();
                $('#scrollTableContainer3').show();
            }
        }).trigger('change');

        $('#LocCode').select2();
        function GetEmpForSup(RegionCode, Designation) {

            if (Designation != "") {
                $.ajax({
                    type: "POST",
                    url: '/Default/GetEmpForOwnSupfrmRegionDesignation',
                    data: JSON.stringify({ RegionCode: RegionCode, Designation: Designation }),
                    dataType: 'json',
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {
                        $('#LocCode').empty();
                        $.each(data, function (i, item) {

                            if (i == 0) {
                                if (data.length > 1) {
                                    $('#LocCode').append('<option value="" selected="selected"></option>');
                                }
                            }
                            $('#LocCode').append($('<option>', { value: item.LocCode, html: item.EmployeeName }, '<option/>'));
                            $('#LocName').val(item.EmployeeName);

                        });

                    },
                    error: function () {
                        alert("Failed to load ... !!");
                    }
                });
            }
            else {
                $('#LocCode').append('<option value="" selected="selected"></option>');
            }
        }


        $('#LocCode').on('change', function () {
            $('#LocName').val($("#LocCode option:selected").text());
        }).trigger('change');



        $('#IsActive').click(function () {
            if ($(this).is(':checked')) {
                $(this).siblings('label').html('Unhide');
                $('#divValueParameter').hide();
            }
            else {
                $(this).siblings('label').html('Hide');
                $('#divValueParameter').show();
            }
        });



   
        $('#btnView').click(function () {
         
            $("body").addClass('sidebar-collapse').trigger('collapsed.pushMenu');
            $('#tBody').html('');
            $('#tBody2').html('');
            $('#tBody3').html('');
            $('#tBody4').html('');
            $('#tBody5').html('');

            var model = {};
            model.Year = $("#Year").val();
            model.MonthNumber = $("#MonthNumber").val();
            model.LocCode = $("#LocCode").val();
            model.EmpCode = $("#EmpCode").val();
            model.EmployeeName = $("#EmployeeName").val();
            model.Designation = $("#Designation").val();
            model.FortNightType = $("#FortNightType").val();

            debugger;

            var Input = InputValidation('Year') + InputValidation('MonthNumber') + InputValidation('Designation') + InputValidation('LocCode');

            if (Input == 0) {
                $("#divLoading").show();
                if (model.Designation == "TM" && (model.FortNightType == "First" || model.FortNightType == "Second")) {
                   
                    GetDetailData(model);
                    GetMonitoringData(model);
                    GetOverallData(model);
                    GetHistoryData(model);
                    GetSupervisorCommentsData(model);          
                }
                else if ((model.Designation == "RSM" || model.Designation == "DSM") && model.FortNightType == "Full" ) {

                    GetDetailData(model);
                    GetMonitoringData(model);
                    GetOverallData(model);
                    GetHistoryData(model);
                    GetSupervisorCommentsData(model);                   
                }
                else {
                    ValidationMsg();
                    toastr.warning($("#MessageText").html());
                }
            }
            else {
                ValidationMsg();
                toastr.warning($("#MessageText").html());
            }

            $("#divLoading").hide();
        });










        function GetDetailData(model) {
            $.ajax({
                type: "POST",
                url: "/ReportFortnightMonitoringTmRsm/GetViewData",
                data: JSON.stringify({ model: model }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    if (data.length > 0) {
                        $("#btnExcel").attr("disabled", false);
                        $("#btnPDF").attr("disabled", false);

                        MainGridView(data);
                    }
                    else {
                        AcknowledgeMsg();
                        toastr.info($("#MessageText").html());

                    }
                },
            });

        }
        function MainGridView(data) {


            $.each(data, function (i, val) {
                var trow = $('<tr></tr>');
                trow.append('<td>' + val.SetDate + '</td>');
                trow.append('<td>' + val.LocName + '</td>');
                trow.append('<td>' + val.InstName + '</td>');
                trow.append('<td>' + val.AllownceNature + '</td>');
                trow.append('<td>' + val.Review + '</td>');
                trow.append('<td>' + val.ColleagueName + '</td>');
                trow.append('<td>' + val.ShiftName + '</td>');
                trow.append('<td>' + val.MDouble + '</td>');
                trow.append('<td>' + val.EDouble + '</td>');
                trow.append('<td>' + val.MSingle + '</td>');
                trow.append('<td>' + val.ESingle + '</td>');
                trow.append('<td>' + val.ChemistCount + '</td>');

                $('#tBody').append(trow);
            });
            groupTable($('#tBody tr:has(td)'), 0, 15);
            $('#tBody .deleted').remove();
        }

        function GetMonitoringData(model) {
            $('#tBody2').html('');
            $.ajax({
                type: "POST",
                url: "/ReportFortnightMonitoringTmRsm/GetViewDataMonitoring",
                data: JSON.stringify({ model: model }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    if (data.length > 0) {
                        $.each(data, function (i, val) {
                            var trow = $('<tr></tr>');
                             trow.append('<td>' + val.LocName + '</td>');
                            trow.append('<td>' + val.EmployeeName + '</td>');
                             trow.append('<td>' + val.Designation + '</td>');
                           
                            trow.append('<td>' + val.SetDate + '</td>');
                            trow.append('<td>' + val.PaperAudit + '</td>');
                            trow.append('<td>' + val.ProblemsIdentifed + '</td>');
                            trow.append('<td>' + val.Remarks + '</td>');


                            $('#tBody2').append(trow);
                        });
                    }
                    //else {
                    //    AcknowledgeMsg();
                    //    toastr.info($("#MessageText").html());

                    //}
                },
            });

        }


        function GetOverallData(model) {
            $('#tBody3').html('');
            $.ajax({
                type: "POST",
                url: "/ReportFortnightMonitoringTmRsm/GetViewDataOverall",
                data: JSON.stringify({ model: model }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    if (data.length > 0) {
                        $.each(data, function (i, val) {
                            var trow = $('<tr></tr>');
                            trow.append('<td>' + val.LocName + '</td>');
                            trow.append('<td>' + val.EmployeeName + '</td>');
                            trow.append('<td>' + val.Designation + '</td>');
                         
                            trow.append('<td>' + val.SetDate + '</td>');
                            trow.append('<td>' + val.Leadership + '</td>');
                            trow.append('<td>' + val.MarketShare + '</td>');

                            trow.append('<td>' + val.SalesAchi + '</td>');
                            trow.append('<td>' + val.Remarks + '</td>');


                            $('#tBody3').append(trow);
                        });
                    }
                    //else {
                    //    AcknowledgeMsg();
                    //    toastr.info($("#MessageText").html());

                    //}
                },
            });

        }

        function GetHistoryData(model) {
            debugger;
            $('#tBody4').html('');
            $('#tHead4').html('');
     
            $.ajax({
                type: "POST",
                url: "/ReportFortnightMonitoringTmRsm/GetViewDataHistory",
                data: JSON.stringify({ model: model }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    if (data.length > 0) {

                        console.log(data);
                        var theadVisitObjectives = $('<thead><tr style="border: 1px solid black; background: #666633;color: white;"> <th COLSPAN="5">' + "Visit Objects(Specific), Root cause of weak performance, Improvement plan with SMART approach and Feedback on previous instruction" + '</th></tr> 	</thead>');   

                        var tTitleVisitObjectives = $('<tr><td>' + "Market" + '</td><td>' + "Employee" + '</td><td>' + "Designation" + '</td><td>' + "Sent Date" + '</td><td>' + "Remarks" + '</td></tr>');  

                        var TitleVisitObjectives = $('<tr style="border: 1px solid black; background: #666633;color: white;"> <th COLSPAN=5>'+  "Visit Objects(Specific)" +'</th></tr>');                  
                        var TitleRootCause = $('<tr style="border: 1px solid black;background: #666633;color: white;"> <th COLSPAN=5>' + "Root cause of weak performance" + '</th></tr>'); 
                        var TitleImprovementPlan = $('<tr style="border: 1px solid black;background: #666633;color: white;"> <th COLSPAN=5>' + "Improvement plan with SMART approach" + '</th></tr>'); 
                        var TitleFeedback = $('<tr style="border: 1px solid black;background: #666633;color: white;"> <th COLSPAN=5>' + "Feedback on previous instruction" + '</th></tr>'); 

                        if (model.Designation == "RSM" || model.Designation == "DSM") {
                            theadVisitObjectives = $('<thead><tr style="border: 1px solid black;font-size: 8px; background: #666633;color: white;"> <th COLSPAN="5">' + "Problems Identified(Paper and Market Related), Measures taken against identified problems (with time limit), Follow up of previously identified problems and measures and Specific comment on market/colleague/competitor/new business opportunity" + '</th></tr> 	</thead>');
                            tTitleVisitObjectives = $('');
                            tTitleVisitObjectives = $('<tr><td COLSPAN=5>' + "" + '</td></tr>');

                             TitleVisitObjectives = $('<tr style="border: 1px solid black; background: #666633;color: white;"> <th COLSPAN=5>' + "Problems Identified(Paper and Market Related)" + '</th></tr>');
                             TitleRootCause = $('<tr style="border: 1px solid black;background: #666633;color: white;"> <th COLSPAN=5>' + "Measures taken against identified problems (with time limit)" + '</th></tr>');
                             TitleImprovementPlan = $('<tr style="border: 1px solid black;background: #666633;color: white;"> <th COLSPAN=5>' + "Follow up of previously identified problems and measures" + '</th></tr>');
                             TitleFeedback = $('<tr style="border: 1px solid black;background: #666633;color: white;"> <th COLSPAN=5>' + "Specific comment on market/colleague/competitor/new business opportunity" + '</th></tr>'); 

                        }

                       
                        var TopHeadVisitObjectives = [];
                        TopHeadVisitObjectives.push(theadVisitObjectives);
                        TopHeadVisitObjectives.push(tTitleVisitObjectives);
                        $('#tHead4').append(TopHeadVisitObjectives);


                        var VisitObjectives = [];
                        VisitObjectives.push(TitleVisitObjectives);
                        var RootCause = [];
                        RootCause.push(TitleRootCause);
                        var ImprovementPlan = [];
                        ImprovementPlan.push(TitleImprovementPlan);
                        var Feedback = [];
                        Feedback.push(TitleFeedback);
                        $.each(data, function (i, val) {

                            var trow = $('<tr></tr>');

                            if (val.ParaType == "VisitObjectives") {                                
                                if (model.Designation == "TM") {
                                    trow.append('<td>' + val.LocName + '</td>');
                                    trow.append('<td>' + val.EmployeeName + '</td>');
                                    trow.append('<td>' + val.Designation + '</td>');
                                    trow.append('<td>' + val.SetDate + '</td>');
                                    trow.append('<td>' + val.Remarks + '</td>');
                                }
                                if (model.Designation == "RSM" || model.Designation == "DSM") {
                                    trow.append('<td COLSPAN=5>' + val.Remarks + '</td>');
                                }                             
                               
                               VisitObjectives.push(trow);
                            }
                            if (val.ParaType == "RootCause") {
                               
                                if (model.Designation == "TM") {
                                    trow.append('<td>' + val.LocName + '</td>');
                                    trow.append('<td>' + val.EmployeeName + '</td>');
                                    trow.append('<td>' + val.Designation + '</td>');
                                    trow.append('<td>' + val.SetDate + '</td>');
                                    trow.append('<td>' + val.Remarks + '</td>');
                                }
                                if (model.Designation == "RSM" || model.Designation == "DSM") {
                                    trow.append('<td COLSPAN=5>' + val.Remarks + '</td>');
                                }
                            
                                RootCause.push(trow);
                            }

                            if (val.ParaType == "ImprovementPlan") {
                          
                                if (model.Designation == "TM") {
                                    trow.append('<td>' + val.LocName + '</td>');
                                    trow.append('<td>' + val.EmployeeName + '</td>');
                                    trow.append('<td>' + val.Designation + '</td>');
                                    trow.append('<td>' + val.SetDate + '</td>');
                                    trow.append('<td>' + val.Remarks + '</td>');
                                }
                                if (model.Designation == "RSM" || model.Designation == "DSM") {
                                    trow.append('<td COLSPAN=5>' + val.Remarks + '</td>');
                                }
                             
                                ImprovementPlan.push(trow);
                            }
                            if (val.ParaType == "Feedback") {
                               
                                if (model.Designation == "TM") {
                                    trow.append('<td>' + val.LocName + '</td>');
                                    trow.append('<td>' + val.EmployeeName + '</td>');
                                    trow.append('<td>' + val.Designation + '</td>');
                                    trow.append('<td>' + val.SetDate + '</td>');
                                    trow.append('<td>' + val.Remarks + '</td>');
                                }
                                if (model.Designation == "RSM" || model.Designation == "DSM") {
                                    trow.append('<td COLSPAN=5>' + val.Remarks + '</td>');
                                }
                               
                                Feedback.push(trow);
                            }
                        });


                        $('#tBody4').append(VisitObjectives);
                        $('#tBody4').append(RootCause);
                        $('#tBody4').append(ImprovementPlan);
                        $('#tBody4').append(Feedback);

                        if (model.Designation == "TM" || model.Designation == "DSM") {
                            groupTable($('#tBody4 tr:has(td)'), 4, 4);
                            $('#tBody4 .deleted').remove();
                        }
                        //if (model.Designation == "RSM") {
                        //    groupTable($('#tBody4 tr:has(td)'), 1, 1);
                        //    $('#tBody4 .deleted').remove();                           
                        //}
                    }
                    //else {
                    //    AcknowledgeMsg();
                    //    toastr.info($("#MessageText").html());

                    //}
                },
            });

        }
        function groupTable($rows, startIndex, total) {
            if (total === 0) {
                return;
            }
            var i, currentIndex = startIndex, count = 1, lst = [];
            var tds = $rows.find('td:eq(' + currentIndex + ')');
            var ctrl = $(tds[0]);
            lst.push($rows[0]);
            for (i = 1; i <= tds.length; i++) {
                if (ctrl.text() == $(tds[i]).text()) {
                    count++;
                    $(tds[i]).addClass('deleted');
                    lst.push($rows[i]);
                }
                else {
                    if (count > 1) {
                        ctrl.attr('rowspan', count);
                        groupTable($(lst), startIndex + 1, total - 1)
                    }
                    count = 1;
                    lst = [];
                    ctrl = $(tds[i]);
                    lst.push($rows[i]);
                }
            }
        }

        
        function GetSupervisorCommentsData(model) {
            $('#tBody5').html('');
            $.ajax({
                type: "POST",
                url: "/ReportFortnightMonitoringTmRsm/GetViewDataSupervisorComments",
                data: JSON.stringify({ model: model }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    if (data.length > 0) {
                        $.each(data, function (i, val) {
                            var trow = $('<tr></tr>');
                            trow.append('<td>' + val.LocName + '</td>');
                            trow.append('<td>' + val.EmployeeName + '</td>');
                            trow.append('<td>' + val.Designation + '</td>');                          
                            trow.append('<td>' + val.SetDate + '</td>');                       
                            trow.append('<td>' + val.Remarks + '</td>');
                              trow.append('<td>' + val.ManagerRemarks + '</td>');

                            $('#tBody5').append(trow);
                        });
                    }
                    //else {
                    //    AcknowledgeMsg();
                    //    toastr.info($("#MessageText").html());

                    //}
                },
            });

        }
    });
</script>


<style>
    .page-break {
        page-break-after: always;
        page-break-inside: avoid;
        clear: both;
    }

    .page-break-before {
        page-break-before: always;
        page-break-inside: avoid;
        clear: both;
    }
</style>



<body>
    <div class="box-header with-border">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

                <form class="form" action="/ReportFortnightMonitoringTmRsm/Export" id="R1Form" method="post" name="H1Form" target="_blank">
                    <div class="row">
                        <div class="col-xs-12 col-sm-12 col-md-2 col-lg-2"><div id="MessageText"></div></div>
                        <div class="col-xs-0 col-sm-0 col-md-10 col-lg-10">
                            <div style="text-align:right;">
                                <input type="checkbox" id="IsActive" class="chk" name="IsActive"> <label for="IsActive"> Hide</label>
                                <button id="btnExcel" class="btn btn-primary btn-sm" name="ExportType" value="Excel" type="submit"><i class="glyphicon glyphicon-envelope"></i> Excel </button>
                                <button id="btnPDF" class="btn btn-primary btn-sm" name="ExportType" value="PDF" type="submit"><i class="glyphicon glyphicon-book"></i> PDF </button>
                                <button id="btnView" class="btn btn-primary btn-sm" type="button"><i class="glyphicon glyphicon-file"></i> View</button>
                            </div>
                        </div>
                    </div>
                            <div class="box-body">

                                <div class="row" id="divValueParameter">
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3"> Month - Year:</div>
                                        <div class="col-xs-0 col-sm-0 col-md-3 col-lg-3">
                                            <div class="input-group">
                                                <select id="MonthNumber" name="MonthNumber" class=" RequiredField form-control"></select>
                                                <span class="input-group-btn" style="width:0px;"></span>
                                                <input type="text" id="Year" name="Year" class="datepicker RequiredField form-control" />
                                                <span class="input-group-btn" style="width:0px;"></span>

                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3">Region Name :</div>
                                        <div class="col-xs-0 col-sm-0 col-md-6 col-lg-6">
                                            <select id="RegionCode" name="RegionCode" class="RequiredField form-control"></select>
                                            <input type="hidden" id="RegionName" name="RegionName" class="RequiredField form-control">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3">Designation - Type :</div>
                                        <div class="col-xs-0 col-sm-0 col-md-6 col-lg-6">
                                            <div class="input-group">
                                                <select id="Designation" name="Designation" class="RequiredField form-control">
                                                    <option value=""></option>
                                                    <option value="DSM">DSM</option>
                                                    <option value="RSM">RSM</option>
                                                    <option value="TM">TM</option>

                                                </select>
                                                <span class="input-group-btn" style="width:10px;"></span>
                                                <select id="FortNightType" name="FortNightType" class="RequiredField form-control">
                                                    <option value="First">First</option>
                                                    <option value="Second">Second</option>
                                                    <option value="Full">Full</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-xs-12 col-sm-6 col-md-3 col-lg-3">Employee Name :</div>
                                        <div class="col-xs-0 col-sm-0 col-md-6 col-lg-6">
                                            <select id="LocCode" name="LocCode" class="RequiredField form-control"></select>
                                            <input type="hidden" id="LocName" name="LocName" class="RequiredField form-control">
                                        </div>
                                        <div class="col-xs-0 col-sm-0 col-md-3 col-lg-3">

                                        </div>
                                    </div>

                                </div>

                                <br />
                                <div class="row">
                                    <div id="scrollTableContainer">
                                        <div id="tHeadContainer">
                                            <table id="tHead">
                                                <tr>
                                                    <td></td>
                                                    <td colspan="2">Worked In</td>
                                                    <td></td>
                                                    <td></td>
                                                    <td colspan="2">Worked With</td>
                                                    <td colspan="5">Visited no of Doctors</td>
                                                </tr>
                                                <tr>
                                                    <td>Date</td>
                                                    <td>Market</td>
                                                    <td>Work Place</td>
                                                    <td>NDA</td>
                                                    <td>TP <br />Followed</td>
                                                    <td>Name of <br />Colleague</td>
                                                    <td>Shift</td>
                                                    <td>Double <br />Morning</td>
                                                    <td>Double <br />Evening</td>
                                                    <td>Single <br />Morning</td>
                                                    <td>Single <br />Evening</td>
                                                    <td>Chemist</td>
                                                </tr>
                                            </table>
                                        </div>
                                        <div id="tBodyContainer">
                                            <table id="tBody"></table>
                                        </div>
                                    </div>
                                </div>
                                <br />
                                <div class="row">
                                    <div id="scrollTableContainer2">
                                        <div id="tHeadContainer2">
                                            <table id="tHead2">
                                                <tr>
                                                    <th COLSPAN="7">
                                                        Audit as per monitoring tool
                                                    </th>
                                                </tr>
                                                <tr>
                                                    <td>Market</td>
                                                    <td>Employee</td>
                                                    <td>Designation</td>

                                                    <td>Sent Date</td>
                                                    <td>Paper Audit</td>
                                                    <td>Problems Identified</td>
                                                    <td>Remarks</td>
                                                </tr>
                                            </table>
                                        </div>
                                        <div id="tBodyContainer2">
                                            <table id="tBody2"></table>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div id="scrollTableContainer3">
                                        <div id="tHeadContainer3">
                                            <table id="tHead3">
                                                <tr>
                                                    <th COLSPAN="8">
                                                        Overall performance
                                                    </th>
                                                </tr>
                                                <tr>
                                                    <td>Market</td>
                                                    <td>Employee</td>
                                                    <td>Designation</td>

                                                    <td>Sent Date</td>
                                                    <td>Leadership</td>
                                                    <td>Market Share</td>
                                                    <td>Sales Achi</td>
                                                    <td>Remarks</td>
                                                </tr>
                                            </table>
                                        </div>
                                        <div id="tBodyContainer3">
                                            <table id="tBody3"></table>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div id="scrollTableContainer4">
                                        <div id="tHeadContainer4">
                                            <table id="tHead4">
                                                @*<tr>
                                        <td>Market</td>
                                        <td>Employee</td>
                                        <td>Designation</td>

                                        <td>Sent Data</td>
                                        <td>Remarks</td>
                                    </tr>*@
                                            </table>
                                        </div>
                                        <div id="tBodyContainer4">
                                            <table id="tBody4"></table>
                                        </div>
                                    </div>
                                </div>


                                <div class="row">
                                    <div id="scrollTableContainer5">
                                        <div id="tHeadContainer5">
                                            <table id="tHead5">
                                                <tr>
                                                    <th COLSPAN="6">
                                                        Manager comments
                                                    </th>
                                                </tr>
                                                <tr>
                                                    <td>Market</td>
                                                    <td>Employee</td>
                                                    <td>Designation</td>

                                                    <td>Sent Date</td>
                                                    <td>RSM Comments</td>
                                                    <td>Manager Comments</td>
                                                </tr>
                                            </table>
                                        </div>
                                        <div id="tBodyContainer5">
                                            <table id="tBody5"></table>
                                        </div>
                                    </div>
                                </div>
                            </div>

                </form>
            </div>
        </div>

        <div id="divLoading" style="margin: 0px; padding: 0px; position: fixed; right: 0px;
    top: 0px; width: 100%; height: 100%; background-color: #666666; z-index: 30001;
    opacity: .8; filter: alpha(opacity=70);display:none">
            <p style="position: absolute; top: 50%; left: 50%; color: White;">
                <img src="~/Content/Images/loading.gif" />
            </p>
        </div>
    </div>


</body>

